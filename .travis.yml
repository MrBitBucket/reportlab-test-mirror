branches:
  only:
  - master
env:
  global:
  - REPO_DIR=reportlab
  - MULTIBUILD_DIR=multibuild
  - MB_ML_VER=2010
  - CONFIG_PATH=.travis-config.sh
  - BUILD_COMMIT=master
  - PLAT=x86_64
  - UNICODE_WIDTH=32
  - BUILD_DEPENDS=""
  - TEST_DEPENDS="pillow"
  - TWINE_USERNAME=MrRLBitBucket
  - CITOOLS_USER=rl-wheelbuilder
  - RLCACHE=manylinux/reportlab
  - secure: AuV15NSlte63TO2Z8ppdt87EHkCqZ61puH8Y7ev/oshGVS27yV3UTLIlAVmvsGptfCrw732gkRIAn0QwWypYnvvhxIvB4kFS6NN7SC3AyI+MBUKuGm4VpzoOGltLd965ODnR1ylT2pdObElhI3TukP2uTZ4d5xtG+++zOfeE98uXAJ4CM2WoEXt888Zo4Gxo78mJWKoBX/Ie7dyM77VHZ+CDL1k8hax2U+7mAQOj+2kIscmH/oOMxMmPSdJiLTxl/46tF3kPuLdUuXxkWkxxJLj6CCGR1q9jM6duqJkbrecttm86OqsYq+fyHSFA7TXfwURq3vmxwAcjqMcp1Dr7BtRzGAAgzKT2rvVpiLzObb6hF9nWHDO8LR+3D/CoXv42tlx8KZImxPvIvY6RSckJGEnzEb3U91vjT2EZgXY2mjKYM74viHMt8I/Bshy96hFNMG5g9XPcwozGtFNGFol4bKSUJLSpB+6xchy3MX5EksLPSFTK8gdtAjUjCuKYSQpJEnA5puNs5fho93QfF0ZrMka5zI8YvJmCPoL64V8zQ38YRM6KCnvIznjBxkG0YFOY2LVghZ96cUbbm9amCPpqyD5uz0xKBs+xHNVFts+KcmclPtYklX6rD5I7v1eu2nX0uwqQkti5fiesJu6ZVxgl+1ddNAEiKcgv1ZOG8TAHHCM=
  # travis encrypt -r MrBitBucket/reportlab-mirror CITOOLS_PASSWORD="**********************" --add with extra bash quoting
language: python
# Default Python version is usually 3.5
python: 3.5
sudo: required
dist: trusty
services: docker

notifications:
  email:
    recipients:
    - bitbucket@reportlab.com
    - live_errors@reportlab.com
    on_success: always
    on_failure: always
matrix:
  exclude:
  # Exclude the default Python 3.5 build
  - python: 3.5
  include:
  - os: linux
    env:
    - UNICODE_WIDTH=16
    - MB_PYTHON_VERSION=2.7
  - os: linux
    env:
    - UNICODE_WIDTH=16
    - MB_PYTHON_VERSION=2.7
    - PLAT=i686
  - os: linux
    env:
    - MB_PYTHON_VERSION=2.7
  - os: linux
    env:
    - MB_PYTHON_VERSION=2.7
    - PLAT=i686
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.5
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.5
    - PLAT=i686
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.6
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.6
    - PLAT=i686
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.7
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.7
    - PLAT=i686
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.8
  - os: linux
    env:
    - MB_PYTHON_VERSION=3.8
    - PLAT=i686
  - os: osx
    language: generic
    env:
    - MB_PYTHON_VERSION=2.7
  - os: osx
    language: generic
    env:
    - MB_PYTHON_VERSION=3.5
  - os: osx
    language: generic
    env:
    - MB_PYTHON_VERSION=3.6
  - os: osx
    language: generic
    env:
    - MB_PYTHON_VERSION=3.7
  - os: osx
    language: generic
    env:
    - MB_PYTHON_VERSION=3.8
    - MB_PYTHON_OSX_VER=10.9
before_install:
- git clone https://github.com/matthew-brett/multibuild $MULTIBUILD_DIR
- cd $MULTIBUILD_DIR
- git checkout b943f33a92772fd52c2fa38c03d08aac974c53bd
- cd ..
- git clone https://github.com/MrBitBucket/reportlab-mirror $REPO_DIR
- source $MULTIBUILD_DIR/common_utils.sh
- source $MULTIBUILD_DIR/travis_steps.sh
- before_install
install:
- clean_code $REPO_DIR $BUILD_COMMIT
- build_wheel $REPO_DIR $PLAT
script:
- install_run $PLAT
after_success:
- pip install https://hg.reportlab.com/hg-public/rl-ci-tools/archive/tip.tar.gz -U
- python -mrl_ci_tools upload-caches --subdir="$RLCACHE" --verbosity=1 ${TRAVIS_BUILD_DIR}/wheelhouse/*
